<div id="wrapper">

  <ul class="sidebar navbar-nav">
    <li class="nav-item">
      <%= link_to root_path, class: "nav-link" do %>
        <i class="fas fa-fw fa-tachometer-alt"></i>
        <span><%= t('panel.pages.sidebar.dashboard') %></span>
      <% end %>
    </li>
    <li class="nav-item">
      <a class="nav-link" href="#">
        <i class="fas fa-fw fa-folder-open"></i>
        <span><%= t('panel.pages.sidebar.files') %></span>
      </a>
    </li>
    <li class="nav-item">
      <%= link_to panel_plan_path, class: "nav-link active" do %>
        <i class="fas fa-fw fa-calendar"></i>
        <span><%= t('panel.pages.sidebar.plan') %></span>
      <% end %>
    </li>
  </ul>

  <div id="content-wrapper">
    <div class="container-fluid">
      <div class="row">
        <div class="col-6 ml-auto mr-auto">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">Tipo de cuenta</h5>
              <hr>
              <div class="row">
                <div class="col">
                  <h6>Plan</h6>
                  <div>
                    <span><%= @subscription.plan.name %></span>
                    <% unless @subscription.free? %>
                      <span><%= link_to "Cancelar suscripción", subscription_path(@subscription), class: "btn btn-danger float-right" , method: :delete, data: {confirm: "¿Estás seguro de que quieres eliminar esta suscripción?"} %></span>
                    <% end %>
                  </div>
                </div>
              </div>
              <hr>
              <div class="row">
                <div class="col">
                  <h6>Estado</h6>
                  <p><span class="badge badge-success"><%= @subscription.status.capitalize %></span></p>
                  <% unless @subscription.free? %>
                    <p>Tu suscripción finalizará el <%= l @subscription.end_date, format: :default %></p>
                  <% end %>
                </div>
              </div>
              <hr>
              <div class="row">
                <div class="col">
                  <h6>Espacio de almacenamiento</h6>
                  <p class="text-right font-weight-light"><span class="font-weight-bold">0 Bytes</span> de <%= @subscription.plan.space_allowed.gigabyte %> Bytes en uso</p>
                  <div class="progress">
                    <div class="progress-bar" role="progressbar" style="width: 50%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">50%</div>
                  </div>
                </div>
              </div>
              <hr>
              <div class="row">
                <div class="col">
                  <h6>Renovación</h6>
                  <% if @subscription.free? %>
                    <p>Sin ciclo de facturación</p>
                  <% else %>
                    <% if @subscription.plan.month? %>
                      <p><%= t('panel.pages.plan.billing_cycle.monthly') %></p>
                    <% else %>
                      <p><%= t('panel.pages.plan.billing_cycle.yearly') %></p>
                    <% end %>
                  <% end %>
                </div>
              </div>
              <hr>
            </div>
          </div>
        </div>
      </div>
      <br>
      <div class="row">
        <div class="col-6 ml-auto mr-auto">
          <div class="card">
            <div class="card-body">
              <h5 class="card-title">Historial de pagos</h5>
              <hr>
              <table class="table table-bordered">
                <thead>
                  <tr>
                    <th>Fecha/Hora</th>
                    <th>Artículo</th>
                    <th>Cantidad</th>
                    <th>Método de pago</th>
                  </tr>
                </thead>
                <tbody>
                  <% current_user.payments.each do |payment| %>
                    <tr>
                      <td><%= payment.created_at %></td>
                      <td><%= payment.payment_line_items.first.buyable.plan.name %></td>
                      <td><%= humanized_money(payment.price) %> &euro;</td>
                      <td><%= payment.payment_method.capitalize %></td>
                    </tr>
                  <% end %>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>

    <%= render 'shared/panel_footer' %>

  </div>

</div>
